"0",""
"0","# Filter top 10 states by total homeless count"
"0","top10_states <- merged %>%"
"0","  arrange(desc(overall_homeless)) %>%"
"0","  slice_head(n = 10)"
"0",""
"0","# Scatter plot with full trendline"
"0","scatter_plot <- ggplot(top10_states, aes(x = population_2023, y = overall_homeless, label = state)) +"
"0","  geom_point(color = ""#2879cb"", alpha = 0.7, size = 3) +"
"0","  geom_smooth(method = ""lm"", se = FALSE, linetype = ""dashed"", color = ""gray40"", fullrange = TRUE) +"
"0","  geom_text_repel(size = 3, max.overlaps = 20, segment.alpha = 0.3) +"
"0","  scale_x_continuous("
"0","    labels = label_number(scale = 1e-6, suffix = ""M""),"
"0","    name = ""State Population"","
"0","    limits = c(0, max(top10_states$population_2023) * 1.05)  # extend beyond California"
"0","  ) +"
"0","  scale_y_continuous("
"0","    labels = label_number(scale = 1e-3, suffix = ""K""),"
"0","    name = ""Homeless Population"""
"0","  ) +"
"0","  labs("
"0","    title = ""Top 10 States: Total Homeless Population vs. State Population (2023)"","
"0","    subtitle = ""Each point shows total homeless count vs. state population."","
"0","    caption = ""Source: HUD AHAR 2023, U.S. Census Bureau"""
"0","  ) +"
"0","  theme_reason() +"
"0","  theme("
"0","    plot.title = element_text(size = 11, face = ""bold""),"
"0","    plot.subtitle = element_text(size = 10),"
"0","    plot.caption = element_text(size = 9),"
"0","    plot.margin = margin(20, 20, 20, 20)"
"0","  )"
"0",""
"0",""
"0","# Combine with Reason logo"
"0","final_scatter_plot <- ggdraw(scatter_plot) +"
"0","  draw_image(logo, x = 0.01, y = -0.035, width = 0.14, height = 0.14, hjust = 0, vjust = 0)"
"1","[38;5;232m`geom_smooth()` using formula = 'y ~ x'[39m
"
"2","Warning:"
"2"," [38;5;232mThe following aesthetics were dropped during statistical transformation: [32mlabel[38;5;232m.
[36mâ„¹[38;5;232m This can happen when ggplot fails to infer the correct grouping structure in the data.
[36mâ„¹[38;5;232m Did you forget to specify a `group` aesthetic or to convert a numerical variable into a factor?[39m
"
"0","# Display"
"0","print(final_scatter_plot)"
